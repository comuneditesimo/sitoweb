@inherits LayoutComponentBase


<link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
<link rel="stylesheet" href="css/telerik/ComunixTheme.css?v=@ComunixSettings.CSSVersion" />

<link href="css/colors/green.css?v=@ComunixSettings.CSSVersion" rel="stylesheet" />
<link rel="stylesheet" href="css/syncfusion/green.css?v=@ComunixSettings.CSSVersion" />

<link rel="stylesheet" href="css/telerik/custom.css?v=@ComunixSettings.CSSVersion" />
<link rel="stylesheet" href="css/backend.min.css?v=@ComunixSettings.CSSVersion" />

<script nonce="comunix123" src="_content/Telerik.UI.for.Blazor/js/telerik-blazor.js"></script>
<script nonce="comunix123" src="https://cdn.lordicon.com/xdjxvujz.js"></script>
<script nonce="comunix123" src="/js/utility/backend/utility.js"></script>
<script nonce="comunix123" src="/js/Formbuilder/formbuilder.js"></script>
<script nonce="comunix123" src="/js/NavMenu/NavMenu_Mobile.js"></script>
<script nonce="comunix123" src="/js/Chat/NotificationHelper.js"></script>
<script type="text/javascript" src="_content/Syncfusion.Blazor.Core/scripts/syncfusion-blazor.min.js"></script> 

<Syncfusion.Blazor.Popups.SfDialogProvider />
<PageTitle>Comunix</PageTitle>

<TelerikRootComponent>
    <BusyIndicator></BusyIndicator>
    <DialogWindow/>
    <PreviewWindow></PreviewWindow>
    <FloatingMenuComponent></FloatingMenuComponent>
    <AuthorizeView Policy="Backend">
        <Authorized>
            @if (EnviromentService.IsMobile)
            {
                <div class="page-header">
                    <div class="page-header-top-row-container">
                        <div class="page-header-top-row">
                            <div class="main-page-top-row-left">
                                @if(SessionWrapper.CurrentUser != null){
                                <h3 class="frontend-loggedin-user">
                                    @(SessionWrapper.CurrentUser.Firstname) @(SessionWrapper.CurrentUser.Lastname)
                                </h3>
                                }
                            </div>
                            <div class="main-page-top-row-right">
                                <div class="mobile-notification-bell">
                                    <TelerikFontIcon IconClass="@("far fa-bell")"></TelerikFontIcon>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="page-header-content-container">
                        <div class="page-header-content">
                            @if (Municipality != null)
                            {
                                <div class="mobile-menu">
                                    <div class="mobile-menu-button-container" onclick="NavMenu_Mobile_OnShow('mobile-menu-popup-container');">
                                        <div class="mobile-menu-button">
                                            <TelerikFontIcon IconClass="@("fas fa-bars")"></TelerikFontIcon>
                                        </div>
                                    </div>
                                    <div id="mobile-menu-popup-container" class="mobile-menu-popup-container mobile-menu-popup-container-hide">
                                        <div class="mobile-menu-container">
                                            <div class="mobile-menu-container-header">
                                                <div class="mobile-header-user-container">
                                                    <div class="mobile-header-user-icon">
                                                        <TelerikFontIcon IconClass="@("fa-solid fa-circle-user")"></TelerikFontIcon>
                                                    </div>
                                                    <div class="mobile-header-user-name">
                                                        <h1 class="mobile-header-first-row">
                                                            @TextProvider.Get("WELCOME")
                                                        </h1>
                                                        @if (SessionWrapper.CurrentUser != null)
                                                        {
                                                            <h2 class="mobile-header-second-row">
                                                                @(SessionWrapper.CurrentUser.Firstname) @(SessionWrapper.CurrentUser.Lastname)!
                                                            </h2>
                                                        }
                                                        else if (SessionWrapper.CurrentMunicipalUser != null)
                                                        {
                                                            <h2 class="mobile-header-second-row">
                                                                @(SessionWrapper.CurrentMunicipalUser.Firstname) @(SessionWrapper.CurrentMunicipalUser.Lastname)!
                                                            </h2>
                                                        }
                                                    </div>
                                                </div>
                                                <div class="mobile-header-action-container">
                                                    <div class="mobile-header-action-container-button" @onclick="HandleLogout">@TextProvider.Get("LOGOUT_BUTTON")</div>
                                                </div>
                                            </div>
                                            <div class="mobile-menu-container-main">
                                                <ICWebApp.Components.Components.MainMenu.Backend.Mobile.NavMenu />
                                            </div>
                                            <div class="mobile-menu-container-footer">
                                                <div class="mobile-language-container">
                                                    <ICWebApp.Components.Components.Localization.Frontend.LanguageComponent></ICWebApp.Components.Components.Localization.Frontend.LanguageComponent>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mobile-menu-popup-close" onclick="NavMenu_Mobile_OnHide('mobile-menu-popup-container');">
                                        </div>
                                    </div>
                                </div>

                                <div class="page-header-branding" @onclick="ReturnToStart">
                                    @if (Municipality.Logo != null)
                                    {
                                        <div class="page-header-logo">
                                            @{
                                                var base64String = string.Format("data:image/png;base64,{0}", Convert.ToBase64String(Municipality.Logo));
                                            }
                                            <img src="@base64String" />
                                        </div>
                                    }
                                    <div class="page-header-title">
                                        <h1 class="page-header-description">@TextProvider.Get("BACKEND_HEADER_BRANDING_DESCRIPTION")</h1>
                                        <h2 class="page-header-municipality">@Municipality.Name</h2>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }

            <div class="main-page backend-page" @onclick="OnScreenClicked">
                @if (!EnviromentService.IsMobile)
                {
                    <div class="main-page-sidebar @SideBarCssClass">
                        <div class="main-page-sidebar-content">
                            <ICWebApp.Components.Components.MainMenu.Backend.Desktop.NavMenu CollapsedSideBar="@CollapseMenu" />
                        </div>
                    </div>
                }
                <main class="main-container backend-main-container @MainCssClass">
                    <article class="main-page-content" id="topelement">
                        <div class="main-page-header">
                            <div class="main-page-breadcrumb">
                                <ICWebApp.Components.Components.Breadcrumb.Backend.Breadcrumb></ICWebApp.Components.Components.Breadcrumb.Backend.Breadcrumb>
                            </div>
                        </div>
                        <div class="small-element-separator"></div>
                        <div class="main-page-body-container">
                            <div class="main-page-body-content">
                                @if (SessionWrapper != null && SessionWrapper.PageTitle != null)
                                {
                                    <h1 class="main-page-title custom-color-primary">@SessionWrapper.PageTitle</h1>
                                }
                               @* @if (SessionWrapper != null && SessionWrapper.PageSubTitle != null)
                                {
                                    <h5 class="main-page-subtitle custom-color-primary">@SessionWrapper.PageSubTitle</h5>
                                }*@
                                <div class="extra-small-element-separator"></div>                               
                                @Body                                
                            </div>
                        </div>
                    </article>
                </main>
            </div>
            @if(SessionWrapper != null && SessionWrapper.CurrentMunicipalUser != null)
            {
                <div style="display: none !important" id="UserID">
                    @SessionWrapper.CurrentMunicipalUser.ID
                </div>
            }
        </Authorized>
        <NotAuthorized>
            <RedirectToLogin></RedirectToLogin>
        </NotAuthorized>
    </AuthorizeView>
</TelerikRootComponent>
